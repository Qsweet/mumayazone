
> server-nest@0.0.1 test:e2e
> jest --config ./test/jest-e2e.json

FAIL test/auth.e2e-spec.ts
  AuthController (e2e)
    Ã— /auth/register (POST) (96 ms)
    Ã— /auth/login (POST) (30 ms)
    Ã— /auth/refresh (POST) (17 ms)
    Ã— /auth/logout (POST) (16 ms)

  â— AuthController (e2e) â€º /auth/register (POST)

    expected 201 "Created", got 400 "Bad Request"

    [0m [90m 41 |[39m             [33m.[39mpost([32m'/auth/register'[39m)
     [90m 42 |[39m             [33m.[39msend(testUser)
    [31m[1m>[22m[39m[90m 43 |[39m             [33m.[39mexpect([35m201[39m)
     [90m    |[39m              [31m[1m^[22m[39m
     [90m 44 |[39m             [33m.[39mexpect((res) [33m=>[39m {
     [90m 45 |[39m                 expect(res[33m.[39mbody[33m.[39maccessToken)[33m.[39mtoBeDefined()[33m;[39m
     [90m 46 |[39m                 [36mconst[39m cookies [33m=[39m res[33m.[39mheaders[[32m'set-cookie'[39m] [36mas[39m unknown [36mas[39m string[][33m;[39m[0m

      at Object.<anonymous> (auth.e2e-spec.ts:43:14)
      ----
      at Test._assertStatus (../node_modules/supertest/lib/test.js:309:14)
      at ../node_modules/supertest/lib/test.js:365:13
      at Test._assertFunction (../node_modules/supertest/lib/test.js:342:13)
      at Test.assert (../node_modules/supertest/lib/test.js:195:23)
      at localAssert (../node_modules/supertest/lib/test.js:138:14)
      at Server.<anonymous> (../node_modules/supertest/lib/test.js:152:11)

  â— AuthController (e2e) â€º /auth/login (POST)

    expected 200 "OK", got 403 "Forbidden"

    [0m [90m 59 |[39m             [33m.[39mpost([32m'/auth/login'[39m)
     [90m 60 |[39m             [33m.[39msend({ email[33m:[39m testUser[33m.[39memail[33m,[39m password[33m:[39m testUser[33m.[39mpassword })
    [31m[1m>[22m[39m[90m 61 |[39m             [33m.[39mexpect([35m200[39m)
     [90m    |[39m              [31m[1m^[22m[39m
     [90m 62 |[39m             [33m.[39mexpect((res) [33m=>[39m {
     [90m 63 |[39m                 expect(res[33m.[39mbody[33m.[39maccessToken)[33m.[39mtoBeDefined()[33m;[39m
     [90m 64 |[39m                 accessToken [33m=[39m res[33m.[39mbody[33m.[39maccessToken[33m;[39m[0m

      at Object.<anonymous> (auth.e2e-spec.ts:61:14)
      ----
      at Test._assertStatus (../node_modules/supertest/lib/test.js:309:14)
      at ../node_modules/supertest/lib/test.js:365:13
      at Test._assertFunction (../node_modules/supertest/lib/test.js:342:13)
      at Test.assert (../node_modules/supertest/lib/test.js:195:23)
      at localAssert (../node_modules/supertest/lib/test.js:138:14)
      at Server.<anonymous> (../node_modules/supertest/lib/test.js:152:11)

  â— AuthController (e2e) â€º /auth/refresh (POST)

    expected 200 "OK", got 401 "Unauthorized"

    [0m [90m 74 |[39m             [33m.[39mpost([32m'/auth/refresh'[39m)
     [90m 75 |[39m             [33m.[39m[36mset[39m([32m'Cookie'[39m[33m,[39m [refreshTokenCookie])
    [31m[1m>[22m[39m[90m 76 |[39m             [33m.[39mexpect([35m200[39m)
     [90m    |[39m              [31m[1m^[22m[39m
     [90m 77 |[39m             [33m.[39mexpect((res) [33m=>[39m {
     [90m 78 |[39m                 expect(res[33m.[39mbody[33m.[39maccessToken)[33m.[39mtoBeDefined()[33m;[39m
     [90m 79 |[39m                 expect(res[33m.[39mbody[33m.[39maccessToken)[33m.[39mnot[33m.[39mtoEqual(accessToken)[33m;[39m[0m

      at Object.<anonymous> (auth.e2e-spec.ts:76:14)
      ----
      at Test._assertStatus (../node_modules/supertest/lib/test.js:309:14)
      at ../node_modules/supertest/lib/test.js:365:13
      at Test._assertFunction (../node_modules/supertest/lib/test.js:342:13)
      at Test.assert (../node_modules/supertest/lib/test.js:195:23)
      at localAssert (../node_modules/supertest/lib/test.js:138:14)
      at Server.<anonymous> (../node_modules/supertest/lib/test.js:152:11)

  â— AuthController (e2e) â€º /auth/logout (POST)

    expected 200 "OK", got 401 "Unauthorized"

    [0m [90m 86 |[39m             [33m.[39mpost([32m'/auth/logout'[39m)
     [90m 87 |[39m             [33m.[39m[36mset[39m([32m'Authorization'[39m[33m,[39m [32m`Bearer ${accessToken}`[39m)
    [31m[1m>[22m[39m[90m 88 |[39m             [33m.[39mexpect([35m200[39m)[33m;[39m
     [90m    |[39m              [31m[1m^[22m[39m
     [90m 89 |[39m     })[33m;[39m
     [90m 90 |[39m })[33m;[39m
     [90m 91 |[39m[0m

      at Object.<anonymous> (auth.e2e-spec.ts:88:14)
      ----
      at Test._assertStatus (../node_modules/supertest/lib/test.js:309:14)
      at ../node_modules/supertest/lib/test.js:365:13
      at Test._assertFunction (../node_modules/supertest/lib/test.js:342:13)
      at Test.assert (../node_modules/supertest/lib/test.js:195:23)
      at localAssert (../node_modules/supertest/lib/test.js:138:14)
      at Server.<anonymous> (../node_modules/supertest/lib/test.js:152:11)

Test Suites: 1 failed, 1 total
Tests:       4 failed, 4 total
Snapshots:   0 total
Time:        2.983 s, estimated 3 s
Ran all test suites.
